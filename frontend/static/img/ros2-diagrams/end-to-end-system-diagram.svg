<svg width="1000" height="600" xmlns="http://www.w3.org/2000/svg">
  <!-- Title -->
  <text x="500" y="30" text-anchor="middle" font-size="16" font-weight="bold">End-to-End ROS 2 System: Sensing, Planning, Action</text>

  <!-- AI Agent Block -->
  <rect x="50" y="100" width="150" height="120" rx="10" ry="10" fill="#9C27B0" stroke="#4A148C" stroke-width="2"/>
  <text x="125" y="125" text-anchor="middle" fill="white" font-size="12" font-weight="bold">AI Agent</text>
  <text x="125" y="145" text-anchor="middle" fill="white" font-size="10">Perception</text>
  <text x="125" y="165" text-anchor="middle" fill="white" font-size="10">Decision Making</text>
  <text x="125" y="185" text-anchor="middle" fill="white" font-size="10">Learning</text>

  <!-- rclpy Bridge -->
  <rect x="230" y="140" width="80" height="40" rx="5" ry="5" fill="#FF9800" stroke="#E65100" stroke-width="2"/>
  <text x="270" y="160" text-anchor="middle" fill="white" font-size="10" font-weight="bold">rclpy</text>

  <!-- ROS 2 Network -->
  <rect x="340" y="80" width="320" height="440" rx="15" ry="15" fill="#E3F2FD" stroke="#1565C0" stroke-width="2" stroke-dasharray="5,5"/>
  <text x="500" y="100" text-anchor="middle" fill="#1565C0" font-size="12" font-weight="bold">ROS 2 Network</text>

  <!-- Sensor Nodes -->
  <rect x="370" y="130" width="120" height="60" rx="8" ry="8" fill="#2196F3" stroke="#0D47A1" stroke-width="2"/>
  <text x="430" y="155" text-anchor="middle" fill="white" font-size="10" font-weight="bold">Sensor Node</text>
  <text x="430" y="170" text-anchor="middle" fill="white" font-size="9">LiDAR/Camera</text>

  <rect x="510" y="130" width="120" height="60" rx="8" ry="8" fill="#2196F3" stroke="#0D47A1" stroke-width="2"/>
  <text x="570" y="155" text-anchor="middle" fill="white" font-size="10" font-weight="bold">IMU Node</text>
  <text x="570" y="170" text-anchor="middle" fill="white" font-size="9">Orientation</text>

  <!-- Processing Nodes -->
  <rect x="370" y="220" width="120" height="60" rx="8" ry="8" fill="#4CAF50" stroke="#2E7D32" stroke-width="2"/>
  <text x="430" y="245" text-anchor="middle" fill="white" font-size="10" font-weight="bold">Perception</text>
  <text x="430" y="260" text-anchor="middle" fill="white" font-size="9">Processing</text>

  <rect x="510" y="220" width="120" height="60" rx="8" ry="8" fill="#4CAF50" stroke="#2E7D32" stroke-width="2"/>
  <text x="570" y="245" text-anchor="middle" fill="white" font-size="10" font-weight="bold">Localization</text>
  <text x="570" y="260" text-anchor="middle" fill="white" font-size="9">SLAM</text>

  <!-- Planning Nodes -->
  <rect x="370" y="310" width="120" height="60" rx="8" ry="8" fill="#FF9800" stroke="#E65100" stroke-width="2"/>
  <text x="430" y="335" text-anchor="middle" fill="white" font-size="10" font-weight="bold">Path Planner</text>
  <text x="430" y="350" text-anchor="middle" fill="white" font-size="9">Global</text>

  <rect x="510" y="310" width="120" height="60" rx="8" ry="8" fill="#FF9800" stroke="#E65100" stroke-width="2"/>
  <text x="570" y="335" text-anchor="middle" fill="white" font-size="10" font-weight="bold">Motion Planner</text>
  <text x="570" y="350" text-anchor="middle" fill="white" font-size="9">Local</text>

  <!-- Control Nodes -->
  <rect x="370" y="400" width="120" height="60" rx="8" ry="8" fill="#F44336" stroke="#B71C1C" stroke-width="2"/>
  <text x="430" y="425" text-anchor="middle" fill="white" font-size="10" font-weight="bold">Motion Control</text>
  <text x="430" y="440" text-anchor="middle" fill="white" font-size="9">Velocity</text>

  <rect x="510" y="400" width="120" height="60" rx="8" ry="8" fill="#F44336" stroke="#B71C1C" stroke-width="2"/>
  <text x="570" y="425" text-anchor="middle" fill="white" font-size="10" font-weight="bold">Hardware Interface</text>
  <text x="570" y="440" text-anchor="middle" fill="white" font-size="9">Actuators</text>

  <!-- Robot Hardware -->
  <rect x="800" y="240" width="150" height="120" rx="10" ry="10" fill="#607D8B" stroke="#37474F" stroke-width="2"/>
  <text x="875" y="270" text-anchor="middle" fill="white" font-size="12" font-weight="bold">Robot Hardware</text>
  <text x="875" y="290" text-anchor="middle" fill="white" font-size="10">Sensors, Motors,</text>
  <text x="875" y="305" text-anchor="middle" fill="white" font-size="10">Actuators, Chassis</text>

  <!-- Data Flow Arrows -->
  <!-- From AI Agent to ROS -->
  <line x1="200" y1="160" x2="230" y2="160" stroke="#212121" stroke-width="3" marker-end="url(#arrowhead)"/>
  <text x="215" y="150" text-anchor="middle" fill="#212121" font-size="8">Commands</text>

  <!-- From ROS to AI Agent -->
  <line x1="230" y1="170" x2="200" y2="170" stroke="#212121" stroke-width="2" stroke-dasharray="5,5" marker-end="url(#arrowhead2)"/>
  <text x="215" y="185" text-anchor="middle" fill="#212121" font-size="8">Sensory Data</text>

  <!-- Sensor to Processing -->
  <line x1="430" y1="190" x2="430" y2="220" stroke="#212121" stroke-width="2" stroke-dasharray="5,5" marker-end="url(#arrowhead)"/>
  <text x="450" y="205" text-anchor="middle" fill="#212121" font-size="8">Raw Data</text>

  <line x1="570" y1="190" x2="570" y2="220" stroke="#212121" stroke-width="2" stroke-dasharray="5,5" marker-end="url(#arrowhead)"/>
  <text x="590" y="205" text-anchor="middle" fill="#212121" font-size="8">Raw Data</text>

  <!-- Processing to Planning -->
  <line x1="430" y1="280" x2="430" y2="310" stroke="#212121" stroke-width="2" stroke-dasharray="5,5" marker-end="url(#arrowhead)"/>
  <text x="450" y="295" text-anchor="middle" fill="#212121" font-size="8">Processed Data</text>

  <line x1="570" y1="280" x2="570" y2="310" stroke="#212121" stroke-width="2" stroke-dasharray="5,5" marker-end="url(#arrowhead)"/>
  <text x="590" y="295" text-anchor="middle" fill="#212121" font-size="8">Pose Data</text>

  <!-- Planning to Control -->
  <line x1="430" y1="370" x2="430" y2="400" stroke="#212121" stroke-width="2" stroke-dasharray="5,5" marker-end="url(#arrowhead)"/>
  <text x="450" y="385" text-anchor="middle" fill="#212121" font-size="8">Path Plan</text>

  <line x1="570" y1="370" x2="570" y2="400" stroke="#212121" stroke-width="2" stroke-dasharray="5,5" marker-end="url(#arrowhead)"/>
  <text x="590" y="385" text-anchor="middle" fill="#212121" font-size="8">Trajectory</text>

  <!-- Control to Hardware -->
  <line x1="430" y1="460" x2="750" y2="300" stroke="#212121" stroke-width="2" stroke-dasharray="5,5" marker-end="url(#arrowhead)"/>
  <text x="590" y="460" text-anchor="middle" fill="#212121" font-size="8">Control Commands</text>

  <line x1="570" y1="460" x2="750" y2="300" stroke="#212121" stroke-width="2" stroke-dasharray="5,5" marker-end="url(#arrowhead)"/>

  <!-- Hardware to Sensors -->
  <line x1="750" y1="300" x2="430" y2="130" stroke="#212121" stroke-width="2" stroke-dasharray="5,5" marker-end="url(#arrowhead2)"/>
  <text x="590" y="110" text-anchor="middle" fill="#212121" font-size="8">Sensor Data</text>

  <line x1="750" y1="300" x2="570" y2="130" stroke="#212121" stroke-width="2" stroke-dasharray="5,5" marker-end="url(#arrowhead2)"/>

  <!-- Arrowhead definitions -->
  <defs>
    <marker id="arrowhead" markerWidth="10" markerHeight="7"
            refX="10" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#212121"/>
    </marker>
    <marker id="arrowhead2" markerWidth="10" markerHeight="7"
            refX="0" refY="3.5" orient="auto">
      <polygon points="10 0, 0 3.5, 10 7" fill="#212121"/>
    </marker>
  </defs>

  <!-- Legend -->
  <rect x="50" y="520" width="900" height="70" fill="none" stroke="#BDBDBD" stroke-width="1"/>
  <rect x="70" y="535" width="15" height="15" fill="#9C27B0" stroke="#4A148C" stroke-width="1"/>
  <text x="95" y="547" fill="#212121" font-size="9">AI Agent</text>

  <rect x="180" y="535" width="15" height="15" fill="#FF9800" stroke="#E65100" stroke-width="1"/>
  <text x="205" y="547" fill="#212121" font-size="9">rclpy Bridge</text>

  <rect x="290" y="535" width="15" height="15" fill="#E3F2FD" stroke="#1565C0" stroke-width="1"/>
  <text x="315" y="547" fill="#212121" font-size="9">ROS 2 Network</text>

  <rect x="420" y="535" width="15" height="15" fill="#2196F3" stroke="#0D47A1" stroke-width="1"/>
  <text x="445" y="547" fill="#212121" font-size="9">Sensors</text>

  <rect x="70" y="560" width="15" height="15" fill="#4CAF50" stroke="#2E7D32" stroke-width="1"/>
  <text x="95" y="572" fill="#212121" font-size="9">Processing</text>

  <rect x="180" y="560" width="15" height="15" fill="#FF9800" stroke="#E65100" stroke-width="1"/>
  <text x="205" y="572" fill="#212121" font-size="9">Planning</text>

  <rect x="290" y="560" width="15" height="15" fill="#F44336" stroke="#B71C1C" stroke-width="1"/>
  <text x="315" y="572" fill="#212121" font-size="9">Control</text>

  <rect x="420" y="560" width="15" height="15" fill="#607D8B" stroke="#37474F" stroke-width="1"/>
  <text x="445" y="572" fill="#212121" font-size="9">Hardware</text>

  <line x1="530" y1="542" x2="545" y2="542" stroke="#212121" stroke-width="2" stroke-dasharray="5,5"/>
  <text x="560" y="545" fill="#212121" font-size="9">ROS Messaging</text>
</svg>